GAMS 24.3.2  r47788 Released Aug 29, 2014 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/03/14 15:03:30 Page 1
WaterSys_Demo.gms
C o m p i l a t i o n


   2  * v time-step by time-step
   3   
   4  ** ----------------------------------------------------------------------
   5  **  Loading Data: sets, parameters and tables
   6  ** ----------------------------------------------------------------------
   7   
INCLUDE    /home/stephen/git/UMPlugins/GAMS/tutorial/gams_model/watersys_demo/hydro-econ_gams.txt
   9  * Data exported from Hydra using GAMSplugin.
  10  * (c) Copyright 2013, 2014, University of Manchester
  11  *
  12  * hydro-econ: Hydro-econ example network.
  13  * Network-ID:  4
  14  * Scenario-ID: 4
  15  *******************************************************************************
  16   
  17  * Network definition
  18   
  19  SETS
  20   
  21  i vector of all nodes /
  22  Desal1
  23  WWTP1
  24  Hp1
  25  J1
  26  J2
  27  J3
  28  SR2
  29  SR3
  30  SR1
  31  GW1
  32  EndPt
  33  SR4
  34  GW2
  35  Urb2
  36  Urb1
  37  Ag2
  38  Ag1
  39      /
  40   
  41  Alias(i,j)
  42   
  43  * Node types
  44   
  45  SETS
  46   
  47  desal(i) /
  48  Desal1
  49  /
  50   
  51  WWTP(i) /
  52  WWTP1
  53  /
  54   
GAMS 24.3.2  r47788 Released Aug 29, 2014 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/03/14 15:03:30 Page 2
WaterSys_Demo.gms
C o m p i l a t i o n


  55  hp(i) /
  56  Hp1
  57  /
  58   
  59  jn(i) /
  60  J1
  61  J2
  62  J3
  63  /
  64   
  65  sr(i) /
  66  SR2
  67  SR3
  68  SR1
  69  SR4
  70  /
  71   
  72  gw(i) /
  73  GW1
  74  GW2
  75  /
  76   
  77  ag(i) /
  78  EndPt
  79  Ag2
  80  Ag1
  81  /
  82   
  83  ur(i) /
  84  Urb2
  85  Urb1
  86  /
  87   
  88  * Node groups
  89   
  90  node_groups vector of all node groups /
  91  mb_ns_nodes
  92  mb_s_nodes
  93  /
  94   
  95  SETS
  96  mb_ns_nodes(i) non-storage nodes where mass balance constraint should be satisfied /
  97  WWTP1
  98  Hp1
  99  J1
 100  J2
 101  EndPt
 102  Urb1
 103  Ag1
 104  /
 105   
 106  SETS
 107  mb_s_nodes(i) storage nodes where mass balance constraint should be satisfied /
GAMS 24.3.2  r47788 Released Aug 29, 2014 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/03/14 15:03:30 Page 3
WaterSys_Demo.gms
C o m p i l a t i o n


 108  Desal1
 109  SR1
 110  GW1
 111  /
 112   
 113  SETS
 114   
 115  links(i,j) vector of all links /
 116  SR2 . SR4
 117  SR1 . J1
 118  J1 . SR2
 119  GW2 . Ag2
 120  GW2 . Ag1
 121  Ag1 . J2
 122  WWTP1 . J2
 123  Urb1 . J1
 124  Ag2 . GW2
 125  Desal1 . Urb2
 126  SR4 . Ag1
 127  WWTP1 . Urb2
 128  Hp1 . SR4
 129  Urb2 . WWTP1
 130  J2 . J3
 131  SR4 . J2
 132  Ag1 . GW2
 133  SR3 . Hp1
 134  J2 . Ag2
 135  Urb1 . GW1
 136  SR4 . Urb2
 137  GW1 . Urb1
 138  Ag2 . J3
 139  J3 . EndPt
 140  SR1 . Urb1
 141      /
 142   
 143  * Link types
 144   
 145  defLink(i,j) /
 146  SR2 . SR4
 147  SR1 . J1
 148  J1 . SR2
 149  Ag1 . J2
 150  Urb1 . J1
 151  Ag2 . GW2
 152  SR4 . Ag1
 153  Hp1 . SR4
 154  Urb2 . WWTP1
 155  J2 . J3
 156  SR4 . J2
 157  Ag1 . GW2
 158  SR3 . Hp1
 159  J2 . Ag2
 160  Urb1 . GW1
GAMS 24.3.2  r47788 Released Aug 29, 2014 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/03/14 15:03:30 Page 4
WaterSys_Demo.gms
C o m p i l a t i o n


 161  SR4 . Urb2
 162  Ag2 . J3
 163  J3 . EndPt
 164  SR1 . Urb1
 165  /
 166   
 167  costLink(i,j) /
 168  GW2 . Ag2
 169  GW2 . Ag1
 170  WWTP1 . J2
 171  Desal1 . Urb2
 172  WWTP1 . Urb2
 173  GW1 . Urb1
 174  /
 175   
 176  * Connectivity matrix.
 177  Table Connect(i,j)
 178                Desal1     WWTP1       Hp1        J1        J2        J3       SR2       SR3       SR1       GW1     EndPt       SR4       GW2      Urb2      Urb1       Ag2       Ag1
 179      Desal1         0         0         0         0         0         0         0         0         0         0         0         0         0         1         0         0         0
 180   
 181       WWTP1         0         0         0         0         1         0         0         0         0         0         0         0         0         1         0         0         0
 182   
 183         Hp1         0         0         0         0         0         0         0         0         0         0         0         1         0         0         0         0         0
 184   
 185          J1         0         0         0         0         0         0         1         0         0         0         0         0         0         0         0         0         0
 186   
 187          J2         0         0         0         0         0         1         0         0         0         0         0         0         0         0         0         1         0
 188   
 189          J3         0         0         0         0         0         0         0         0         0         0         1         0         0         0         0         0         0
 190   
 191         SR2         0         0         0         0         0         0         0         0         0         0         0         1         0         0         0         0         0
 192   
 193         SR3         0         0         1         0         0         0         0         0         0         0         0         0         0         0         0         0         0
 194   
 195         SR1         0         0         0         1         0         0         0         0         0         0         0         0         0         0         1         0         0
 196   
 197         GW1         0         0         0         0         0         0         0         0         0         0         0         0         0         0         1         0         0
 198   
 199       EndPt         0         0         0         0         0         0         0         0         0         0         0         0         0         0         0         0         0
 200   
 201         SR4         0         0         0         0         1         0         0         0         0         0         0         0         0         1         0         0         1
 202   
 203         GW2         0         0         0         0         0         0         0         0         0         0         0         0         0         0         0         1         1
 204   
 205        Urb2         0         1         0         0         0         0         0         0         0         0         0         0         0         0         0         0         0
 206   
 207        Urb1         0         0         0         1         0         0         0         0         0         1         0         0         0         0         0         0         0
 208   
 209         Ag2         0         0         0         0         0         1         0         0         0         0         0         0         1         0         0         0         0
 210   
 211         Ag1         0         0         0         0         1         0         0         0         0         0         0         0         1         0         0         0         0
 212   
 213  SETS
GAMS 24.3.2  r47788 Released Aug 29, 2014 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/03/14 15:03:30 Page 5
WaterSys_Demo.gms
C o m p i l a t i o n


 214   
 215  * Time index
 216  t time index /
 217  0
 218  1
 219  2
 220  3
 221  4
 222  5
 223  6
 224  7
 225  8
 226  9
 227  10
 228  11
 229  /
 230   
 231  * define time steps dependent on time index (t)
 232   
 233  Parameter timestamp(t) ;
 234   
 235      timestamp("0") = 693596.0 ;
 236      timestamp("1") = 693626.43684 ;
 237      timestamp("2") = 693656.873692 ;
 238      timestamp("3") = 693687.310544 ;
 239      timestamp("4") = 693717.747396 ;
 240      timestamp("5") = 693748.184248 ;
 241      timestamp("6") = 693778.621088 ;
 242      timestamp("7") = 693809.05794 ;
 243      timestamp("8") = 693839.494792 ;
 244      timestamp("9") = 693869.931644 ;
 245      timestamp("10") = 693900.368495 ;
 246      timestamp("11") = 693930.805347 ;
 247   
 248   
 249  * Node data
 250   
 251  * Data for node type desal
 252   
 253  SETS
 254   
 255  desal_scalars /
 256  maxStor
 257  minStor
 258  IC
 259  /
 260   
 261  Table desal_scalar_data(i,desal_scalars)
 262   
 263                                  maxStor        minStor             IC
 264  Desal1                         100000.0            0.0        10000.0
 265   
 266   
GAMS 24.3.2  r47788 Released Aug 29, 2014 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/03/14 15:03:30 Page 6
WaterSys_Demo.gms
C o m p i l a t i o n


 267  * Data for node type WWTP
 268   
 269  SETS
 270   
 271  WWTP_scalars /
 272  Cost
 273  /
 274   
 275  Table WWTP_scalar_data(i,WWTP_scalars)
 276   
 277                                     Cost
 278  WWTP1                               8.0
 279   
 280   
 281  * Data for node type hp
 282   
 283  * Data for node type jn
 284   
 285  SETS
 286   
 287  jn_scalars /
 288  BC
 289  /
 290   
 291  Table jn_scalar_data(i,jn_scalars)
 292   
 293                                       BC
 294  J1                                  0.0
 295  J2                                  0.0
 296  J3                                  0.0
 297   
 298   
 299  * Data for node type sr
 300   
 301  SETS
 302   
 303  sr_scalars /
 304  maxStor
 305  minStor
 306  /
 307   
 308  Table sr_scalar_data(i,sr_scalars)
 309   
 310                                  maxStor        minStor
 311  SR2                               200.0           20.0
 312  SR3                               300.0           30.0
 313  SR1                               500.0           50.0
 314  SR4                               600.0           60.0
 315   
 316   
 317  SETS
 318   
 319  sr_timeseries /
GAMS 24.3.2  r47788 Released Aug 29, 2014 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/03/14 15:03:30 Page 7
WaterSys_Demo.gms
C o m p i l a t i o n


 320  BC
 321  IC
 322  /
 323   
 324  Table sr_timeseries_data(t,i,sr_timeseries)
 325   
 326                  SR2.BC         SR3.BC         SR1.BC         SR4.BC         SR2.IC         SR3.IC         SR1.IC         SR4.IC
 327  0
 328  1
 329  2
 330  3
 331  4
 332  5
 333  6
 334  7
 335  8
 336  9
 337  10
 338  11
 339   
 340  * Data for node type gw
 341   
 342  SETS
 343   
 344  gw_scalars /
 345  maxStor
 346  minStor
 347  /
 348   
 349  Table gw_scalar_data(i,gw_scalars)
 350   
 351                                  maxStor        minStor
 352  GW1                              2000.0          300.0
 353  GW2                              2000.0          300.0
 354   
 355   
 356  SETS
 357   
 358  gw_timeseries /
 359  BC
 360  IC
 361  /
 362   
 363  Table gw_timeseries_data(t,i,gw_timeseries)
 364   
 365                  GW1.BC         GW2.BC         GW1.IC         GW2.IC
 366  0
 367  1
 368  2
 369  3
 370  4
 371  5
 372  6
GAMS 24.3.2  r47788 Released Aug 29, 2014 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/03/14 15:03:30 Page 8
WaterSys_Demo.gms
C o m p i l a t i o n


 373  7
 374  8
 375  9
 376  10
 377  11
 378   
 379  * Data for node type ag
 380   
 381  SETS
 382   
 383  ag_scalars /
 384  Consumption
 385  /
 386   
 387  Table ag_scalar_data(i,ag_scalars)
 388   
 389                              Consumption
 390  EndPt                               1.0
 391  Ag2                                 0.7
 392  Ag1                                 0.7
 393   
 394   
 395  SETS
 396   
 397  ag_timeseries /
 398  linCoeff
 399  quadCoeff
 400  BC
 401  /
 402   
 403  Table ag_timeseries_data(t,i,ag_timeseries)
 404   
 405            Ag2.linCoeff   Ag1.linCoeff  Ag2.quadCoeff  Ag1.quadCoeff         Ag1.BC
 406  0          1100.000000    1000.000000      -9.000000     -10.000000
 407  1          1100.000000    1000.000000      -9.000000     -10.000000
 408  2          1500.000000    1400.000000      -7.000000      -8.000000
 409  3          1700.000000    1600.000000      -6.000000      -7.000000
 410  4          1900.000000    1800.000000      -5.000000      -6.000000
 411  5          2100.000000    2000.000000      -4.000000      -5.000000
 412  6          2100.000000    2000.000000      -3.000000      -4.000000
 413  7          2100.000000    2000.000000      -3.000000      -4.000000
 414  8          1900.000000    1800.000000      -4.000000      -5.000000
 415  9          1700.000000    1600.000000      -5.000000      -6.000000
 416  10         1500.000000    1400.000000      -6.000000      -7.000000
 417  11         1300.000000    1200.000000      -7.000000      -8.000000
 418   
 419  * Array test_array for node EndPt, dimensions are [3, 3]
 420   
 421  SETS
 422   
 423  a_EndPt_test_array array index /
 424  0
 425  1
GAMS 24.3.2  r47788 Released Aug 29, 2014 LEX-LEG x86 64bit/Linux                                                                                                                                                                      10/03/14 15:03:30 Page 9
WaterSys_Demo.gms
C o m p i l a t i o n


 426  2
 427  /
 428   
 429  b_EndPt_test_array array index /
 430  0
 431  1
 432  2
 433  /
 434   
 435  Table EndPt_test_array(a_EndPt_test_array,b_EndPt_test_array)
 436   
 437                     0                   1                   2
 438  0                1.00                2.00                3.0
 439  1                4.01                5.01                6.0
 440  2                7.02                8.02                9.0
 441   
 442   
 443  * Data for node type ur
 444   
 445  SETS
 446   
 447  ur_scalars /
 448  linCoeff
 449  quadCoeff
 450  Consumption
 451  /
 452   
 453  Table ur_scalar_data(i,ur_scalars)
 454   
 455                                 linCoeff      quadCoeff    Consumption
 456  Urb2                             2500.0           -7.0            0.5
 457  Urb1                             1500.0           -5.0            0.5
 458   
 459   
 460  * Link data
 461   
 462  * Data for link type defLink
 463   
 464  SETS
 465   
 466  defLink_scalars /
 467  lossCoeff
 468  maxFlow
 469  minFlow
 470  /
 471   
 472  Table defLink_scalar_data(i,j,defLink_scalars)
 473   
 474                                lossCoeff        maxFlow        minFlow
 475  SR2 . SR4                           1.0          100.0           10.0
 476  SR1 . J1                            1.0          100.0           10.0
 477  J1 . SR2                            1.0          100.0           10.0
 478  Ag1 . J2                           0.95          100.0            0.0
GAMS 24.3.2  r47788 Released Aug 29, 2014 LEX-LEG x86 64bit/Linux                                                                                                                                                                     10/03/14 15:03:30 Page 10
WaterSys_Demo.gms
C o m p i l a t i o n


 479  Urb1 . J1                           1.0          100.0            0.0
 480  Ag2 . GW2                           1.0          100.0            0.0
 481  SR4 . Ag1                          0.95          100.0            1.0
 482  Hp1 . SR4                           1.0          100.0           10.0
 483  Urb2 . WWTP1                        1.0          100.0            0.0
 484  J2 . J3                             0.9          200.0           10.0
 485  SR4 . J2                           0.95          200.0           10.0
 486  Ag1 . GW2                           1.0          100.0            0.0
 487  SR3 . Hp1                           1.0          100.0           10.0
 488  J2 . Ag2                            1.0          100.0            0.0
 489  Urb1 . GW1                          1.0          100.0            0.0
 490  SR4 . Urb2                          1.0          100.0           10.0
 491  Ag2 . J3                            1.0          100.0            0.0
 492  J3 . EndPt                          1.0          350.0          175.0
 493  SR1 . Urb1                          1.0          100.0           10.0
 494   
 495   
 496  * Data for link type costLink
 497   
 498  SETS
 499   
 500  costLink_scalars /
 501  Cost
 502  minFlow
 503  maxFlow
 504  lossCoeff
 505  /
 506   
 507  Table costLink_scalar_data(i,j,costLink_scalars)
 508   
 509                                     Cost        minFlow        maxFlow      lossCoeff
 510  GW2 . Ag2                          15.0            0.0           80.0            1.0
 511  GW2 . Ag1                          15.0            0.0           80.0            1.0
 512  WWTP1 . J2                         20.0            0.0           80.0            1.0
 513  Desal1 . Urb2                      60.0            0.0           80.0            1.0
 514  WWTP1 . Urb2                       50.0            0.0           80.0            1.0
 515  GW1 . Urb1                         10.0            0.0           80.0            1.0
 516   
 517   
 518   
 519  ** ----------------------------------------------------------------------
 520  **  Model variables and equations
 521  ** ----------------------------------------------------------------------
 522   
 523  VARIABLES
 524  Q(i,j,t) flow in each link in each period
 525  S(i,t) storage volume in storage nodes
 526  Z objective function
 527  ;
 528   
 529  POSITIVE VARIABLES
 530  Q
 531  S
GAMS 24.3.2  r47788 Released Aug 29, 2014 LEX-LEG x86 64bit/Linux                                                                                                                                                                     10/03/14 15:03:30 Page 11
WaterSys_Demo.gms
C o m p i l a t i o n


 532  ;
 533   
 534  EQUATIONS
 535  MassBalance_nonstorage(mb_ns_nodes,t)
 536  MassBalance_storage(mb_s_nodes,t)
 537  MinFlow(i,j,t)
 538  MaxFlow(i,j,t)
 539  MaxStor(mb_s_nodes,t)
 540  MinStor(mb_s_nodes,t)
 541  Objective
 542  ;
 543   
 544  * Objective function for time step by time step formulation
 545   
 546  Objective ..
 547      Z =E= SUM(t,SUM((i,j)$links(i,j), Q(i,j,t) * cost(i,j,t)));
****                                                      $140
**** LINE     38 INPUT       /home/stephen/git/UMPlugins/GAMS/tutorial/gams_model/watersys_demo/watersys_demo.gms
 548   
 549  * Mass balance constrait for non-storage nodes
 550   
 551  MassBalance_nonstorage(mb_ns_nodes,t) ..
 552      SUM(j$links(j,mb_ns_nodes), Q(j,mb_ns_nodes,t) * flowmultiplier(j,mb_ns_nodes,t))
****                                                                    $140
**** LINE     43 INPUT       /home/stephen/git/UMPlugins/GAMS/tutorial/gams_model/watersys_demo/watersys_demo.gms
 553      - SUM(j$links(mb_ns_nodes,j), Q(mb_ns_nodes,j,t))
 554      =E= 0;
 555   
 556  * Storage constraint for storage nodes:
 557   
 558  MassBalance_storage(mb_s_nodes,t)..
 559   
 560           SUM(j$Connect(j,mb_s_nodes), Q(j,mb_s_nodes,t))
 561           - SUM(j$Connect(mb_s_nodes,j), Q(mb_s_nodes,j,t) * flowmultiplier(mb_s_nodes,j,t) )
 562           -S(mb_s_nodes,t)
 563           +S(mb_s_nodes,t--1)$(ord(t) GT 1)
 564           + initStor(mb_s_nodes,t)$(ord(t) EQ 1)
****                    $140
**** LINE     55 INPUT       /home/stephen/git/UMPlugins/GAMS/tutorial/gams_model/watersys_demo/watersys_demo.gms
 565           =E= 0;
 566   
 567  * Lower and upper bound of possible flow in links
 568   
 569  MinFlow(i,j,t)$links(i,j) ..
 570      Q(i,j,t) =G= lower(i,j,t);
****                       $140
**** LINE     61 INPUT       /home/stephen/git/UMPlugins/GAMS/tutorial/gams_model/watersys_demo/watersys_demo.gms
 571   
 572  MaxFlow(i,j,t)$links(i,j) ..
 573      Q(i,j,t) =L= upper(i,j,t);
****                       $140
**** LINE     64 INPUT       /home/stephen/git/UMPlugins/GAMS/tutorial/gams_model/watersys_demo/watersys_demo.gms
 574   
GAMS 24.3.2  r47788 Released Aug 29, 2014 LEX-LEG x86 64bit/Linux                                                                                                                                                                     10/03/14 15:03:30 Page 12
WaterSys_Demo.gms
C o m p i l a t i o n


 575  * Lower and upper bound of Storage volume at storage nodes
 576  MaxStor(mb_s_nodes,t)..
 577      S(mb_s_nodes,t) =L= storageupper(mb_s_nodes,t);
****                                     $140
**** LINE     68 INPUT       /home/stephen/git/UMPlugins/GAMS/tutorial/gams_model/watersys_demo/watersys_demo.gms
 578   
 579  MinStor(mb_s_nodes,t)..
 580      S(mb_s_nodes,t) =G= storagelower(mb_s_nodes,t);
****                                     $140
**** LINE     71 INPUT       /home/stephen/git/UMPlugins/GAMS/tutorial/gams_model/watersys_demo/watersys_demo.gms
 581   
 582  ** ----------------------------------------------------------------------
 583  **  Model declaration and solve statements
 584  ** ----------------------------------------------------------------------
 585   
 586  MODEL WaterSys_Demo /ALL/;
 587   
 588  SOLVE WaterSys_Demo USING LP MINIMIZING Z;
****                                           $257
**** LINE     79 INPUT       /home/stephen/git/UMPlugins/GAMS/tutorial/gams_model/watersys_demo/watersys_demo.gms
 589   
 590  execute_unload "Results.gdx" ,
 591      Q,
 592      S,
 593      MassBalance_storage,
 594      MassBalance_nonstorage,
 595      Z
GAMS 24.3.2  r47788 Released Aug 29, 2014 LEX-LEG x86 64bit/Linux                                                                                                                                                                     10/03/14 15:03:30 Page 13
WaterSys_Demo.gms
Error Messages


140  Unknown symbol
257  Solve statement not checked because of previous errors

**** 8 ERROR(S)   0 WARNING(S)
GAMS 24.3.2  r47788 Released Aug 29, 2014 LEX-LEG x86 64bit/Linux                                                                                                                                                                     10/03/14 15:03:30 Page 14
WaterSys_Demo.gms
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  /home/stephen/git/UMPlugins/GAMS/tutorial/gams_model/watersys_demo/watersys_demo.gms
     2        8 INCLUDE        1       8  ./home/stephen/git/UMPlugins/GAMS/tutorial/gams_model/watersys_demo/hydro-econ_gams.txt


COMPILATION TIME     =        0.002 SECONDS      3 MB  24.3.2 r47788 LEX-LEG


USER: Course License 2014 Julien Harou               S140409:0435AO-GEN
      University College London, Dep. of Civil, Environmental & GDC9412
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/stephen/git/UMPlugins/GAMS/tutorial/gams_model/watersys_demo/watersys_demo.gms
Output     /home/stephen/git/UMPlugins/GAMS/tutorial/gams_model/watersys_demo/watersys_demo.lst

**** USER ERROR(S) ENCOUNTERED
